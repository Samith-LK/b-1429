import{j as e}from"./vendor-tanstack.DHMS-LsQ.js";import{r as t}from"./vendor-react.BX3Y0FtA.js";import{M as n,u as s,P as o,a as r,L as i}from"./ScrollFadeIn.Yb3IUxRd.js";class c extends t.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u({children:s,isPresent:o}){const r=t.useId(),i=t.useRef(null),u=t.useRef({width:0,height:0,top:0,left:0}),{nonce:l}=t.useContext(n);return t.useInsertionEffect((()=>{const{width:e,height:t,top:n,left:s}=u.current;if(o||!i.current||!e||!t)return;i.current.dataset.motionPopId=r;const c=document.createElement("style");return l&&(c.nonce=l),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`\n          [data-motion-pop-id="${r}"] {\n            position: absolute !important;\n            width: ${e}px !important;\n            height: ${t}px !important;\n            top: ${n}px !important;\n            left: ${s}px !important;\n          }\n        `),()=>{document.head.removeChild(c)}}),[o]),e.jsx(c,{isPresent:o,childRef:i,sizeRef:u,children:t.cloneElement(s,{ref:i})})}const l=({children:n,initial:r,isPresent:i,onExitComplete:c,custom:l,presenceAffectsLayout:d,mode:f})=>{const p=s(a),h=t.useId(),m=t.useCallback((e=>{p.set(e,!0);for(const t of p.values())if(!t)return;c&&c()}),[p,c]),x=t.useMemo((()=>({id:h,initial:r,isPresent:i,custom:l,onExitComplete:m,register:e=>(p.set(e,!1),()=>p.delete(e))})),d?[Math.random(),m]:[i,m]);return t.useMemo((()=>{p.forEach(((e,t)=>p.set(t,!1)))}),[i]),t.useEffect((()=>{!i&&!p.size&&c&&c()}),[i]),"popLayout"===f&&(n=e.jsx(u,{isPresent:i,children:n})),e.jsx(o.Provider,{value:x,children:n})};function a(){return new Map}const d=e=>e.key||"";function f(e){const n=[];return t.Children.forEach(e,(e=>{t.isValidElement(e)&&n.push(e)})),n}const p=({children:n,exitBeforeEnter:o,custom:c,initial:u=!0,onExitComplete:a,presenceAffectsLayout:p=!0,mode:h="sync"})=>{const m=t.useMemo((()=>f(n)),[n]),x=m.map(d),g=t.useRef(!0),E=t.useRef(m),C=s((()=>new Map)),[P,j]=t.useState(m),[v,R]=t.useState(m);r((()=>{g.current=!1,E.current=m;for(let e=0;e<v.length;e++){const t=d(v[e]);x.includes(t)?C.delete(t):!0!==C.get(t)&&C.set(t,!1)}}),[v,x.length,x.join("-")]);const w=[];if(m!==P){let e=[...m];for(let t=0;t<v.length;t++){const n=v[t],s=d(n);x.includes(s)||(e.splice(t,0,n),w.push(n))}return"wait"===h&&w.length&&(e=w),R(f(e)),void j(m)}const{forceRender:y}=t.useContext(i);return e.jsx(e.Fragment,{children:v.map((t=>{const n=d(t),s=m===v||x.includes(n);return e.jsx(l,{isPresent:s,initial:!(g.current&&!u)&&void 0,custom:s?void 0:c,presenceAffectsLayout:p,mode:h,onExitComplete:s?void 0:()=>{if(!C.has(n))return;C.set(n,!0);let e=!0;C.forEach((t=>{t||(e=!1)})),e&&(null==y||y(),R(E.current),a&&a())},children:t},n)}))})};export{p as A};
